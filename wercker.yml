box: golang:1.7
build:
  base-path: /go/src/github.com/wercker/pkg
  steps:
    - golint:
        exclude: "^vendor"

    - script:
        name: install govendor
        code: go get -u github.com/kardianos/govendor

    - script:
        name: go vet
        code: govendor vet +local

    - script:
        name: force "go get" over ssh
        code: git config --global url."git@github.com:".insteadOf "https://github.com/"

    - add-ssh-key:
        keyname: WALTERBOT

    - add-to-known_hosts:
        hostname: github.com
        fingerprint: 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48
        type: rsa

    - script:
        name: install dependencies
        code: |
          govendor sync
          govendor list

    - script:
        name: go test
        code: CGO_ENABLED=0 govendor test +local
